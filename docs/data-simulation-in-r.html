<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Data simulation in R | Course on Mixed-effects Models</title>
  <meta name="description" content="Chapter 12 Data simulation in R | Course on Mixed-effects Models" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Data simulation in R | Course on Mixed-effects Models" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/nwickel/mixed_models/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Data simulation in R | Course on Mixed-effects Models" />
  
  
  

<meta name="author" content="Nora Wickelmaier" />


<meta name="date" content="2025-05-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalized-linear-mixed-effects-models.html"/>
<link rel="next" href="power-simulation-for-lmms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mixed-effects Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course information</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#desirable-background-knowledge"><i class="fa fa-check"></i>Desirable background knowledge</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#overview-of-dates-and-topics"><i class="fa fa-check"></i>Overview of dates and topics</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ws-202425"><i class="fa fa-check"></i>WS 2024/25</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ss-2025"><i class="fa fa-check"></i>SS 2025</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#literature"><i class="fa fa-check"></i>Literature</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html"><i class="fa fa-check"></i><b>1</b> Simple and multiple regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#slides"><i class="fa fa-check"></i><b>1.1</b> Slides</a></li>
<li class="chapter" data-level="1.2" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#example-to-illustrate-assumptions"><i class="fa fa-check"></i><b>1.2</b> Example to illustrate assumptions</a></li>
<li class="chapter" data-level="1.3" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="simple-and-multiple-regression.html"><a href="simple-and-multiple-regression.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#slides-1"><i class="fa fa-check"></i><b>2.1</b> Slides</a></li>
<li class="chapter" data-level="2.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#exercises-1"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prepost-measurements.html"><a href="prepost-measurements.html"><i class="fa fa-check"></i><b>3</b> Pre/post measurements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prepost-measurements.html"><a href="prepost-measurements.html#slides-2"><i class="fa fa-check"></i><b>3.1</b> Slides</a></li>
<li class="chapter" data-level="3.2" data-path="prepost-measurements.html"><a href="prepost-measurements.html#exercises-2"><i class="fa fa-check"></i><b>3.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="prepost-measurements.html"><a href="prepost-measurements.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="prepost-measurements.html"><a href="prepost-measurements.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="prepost-measurements.html"><a href="prepost-measurements.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="longitudinal-data.html"><a href="longitudinal-data.html"><i class="fa fa-check"></i><b>4</b> Longitudinal data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="longitudinal-data.html"><a href="longitudinal-data.html#slides-3"><i class="fa fa-check"></i><b>4.1</b> Slides</a></li>
<li class="chapter" data-level="4.2" data-path="longitudinal-data.html"><a href="longitudinal-data.html#exercises-3"><i class="fa fa-check"></i><b>4.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="longitudinal-data.html"><a href="longitudinal-data.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measurements.html"><a href="repeated-measurements.html"><i class="fa fa-check"></i><b>5</b> Repeated measurements</a>
<ul>
<li class="chapter" data-level="5.1" data-path="repeated-measurements.html"><a href="repeated-measurements.html#slides-4"><i class="fa fa-check"></i><b>5.1</b> Slides</a></li>
<li class="chapter" data-level="5.2" data-path="repeated-measurements.html"><a href="repeated-measurements.html#exercises-4"><i class="fa fa-check"></i><b>5.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="repeated-measurements.html"><a href="repeated-measurements.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="growth-curve-models.html"><a href="growth-curve-models.html"><i class="fa fa-check"></i><b>6</b> Growth curve models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="growth-curve-models.html"><a href="growth-curve-models.html#slides-5"><i class="fa fa-check"></i><b>6.1</b> Slides</a></li>
<li class="chapter" data-level="6.2" data-path="growth-curve-models.html"><a href="growth-curve-models.html#exercises-5"><i class="fa fa-check"></i><b>6.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curve-models.html"><a href="growth-curve-models.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="crossed-random-effects.html"><a href="crossed-random-effects.html"><i class="fa fa-check"></i><b>7</b> Crossed random effects</a>
<ul>
<li class="chapter" data-level="7.1" data-path="crossed-random-effects.html"><a href="crossed-random-effects.html#slides-6"><i class="fa fa-check"></i><b>7.1</b> Slides</a></li>
<li class="chapter" data-level="7.2" data-path="crossed-random-effects.html"><a href="crossed-random-effects.html#exercises-6"><i class="fa fa-check"></i><b>7.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="crossed-random-effects.html"><a href="crossed-random-effects.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="crossed-random-effects.html"><a href="crossed-random-effects.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="random-effects-for-within-subject-designs.html"><a href="random-effects-for-within-subject-designs.html"><i class="fa fa-check"></i><b>8</b> Random effects for within-subject designs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="random-effects-for-within-subject-designs.html"><a href="random-effects-for-within-subject-designs.html#slides-7"><i class="fa fa-check"></i><b>8.1</b> Slides</a></li>
<li class="chapter" data-level="8.2" data-path="random-effects-for-within-subject-designs.html"><a href="random-effects-for-within-subject-designs.html#exercises-7"><i class="fa fa-check"></i><b>8.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="random-effects-for-within-subject-designs.html"><a href="random-effects-for-within-subject-designs.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="random-effects-for-within-subject-designs.html"><a href="random-effects-for-within-subject-designs.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrast-coding.html"><a href="contrast-coding.html"><i class="fa fa-check"></i><b>9</b> Contrast coding</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrast-coding.html"><a href="contrast-coding.html#slides-8"><i class="fa fa-check"></i><b>9.1</b> Slides</a></li>
<li class="chapter" data-level="9.2" data-path="contrast-coding.html"><a href="contrast-coding.html#exercises-8"><i class="fa fa-check"></i><b>9.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="contrast-coding.html"><a href="contrast-coding.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="contrast-coding.html"><a href="contrast-coding.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>10</b> Multilevel models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multilevel-models.html"><a href="multilevel-models.html#slides-9"><i class="fa fa-check"></i><b>10.1</b> Slides</a></li>
<li class="chapter" data-level="10.2" data-path="multilevel-models.html"><a href="multilevel-models.html#exercises-9"><i class="fa fa-check"></i><b>10.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#exercise-1-9"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>11</b> Generalized linear mixed-effects models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#slides-10"><i class="fa fa-check"></i><b>11.1</b> Slides</a></li>
<li class="chapter" data-level="11.2" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#exercises-10"><i class="fa fa-check"></i><b>11.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="generalized-linear-mixed-effects-models.html"><a href="generalized-linear-mixed-effects-models.html#exercise-1-10"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html"><i class="fa fa-check"></i><b>12</b> Data simulation in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#random-numbers-generation"><i class="fa fa-check"></i><b>12.2</b> Random numbers generation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#normal-distribution"><i class="fa fa-check"></i><b>12.2.1</b> Normal distribution</a></li>
<li class="chapter" data-level="12.2.2" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>12.2.2</b> Multivariate normal distribution</a></li>
<li class="chapter" data-level="12.2.3" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#poisson-distribution-for-count-data"><i class="fa fa-check"></i><b>12.2.3</b> Poisson distribution (for count data)</a></li>
<li class="chapter" data-level="12.2.4" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#binomial-distribution"><i class="fa fa-check"></i><b>12.2.4</b> Binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#creating-factors"><i class="fa fa-check"></i><b>12.3</b> Creating factors</a></li>
<li class="chapter" data-level="12.4" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#data-frames"><i class="fa fa-check"></i><b>12.4</b> Data frames</a></li>
<li class="chapter" data-level="12.5" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#simulate-repeatedly"><i class="fa fa-check"></i><b>12.5</b> Simulate repeatedly</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#simulate-many-data-sets"><i class="fa fa-check"></i><b>12.5.1</b> Simulate many data sets</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#example-type-i-error"><i class="fa fa-check"></i><b>12.6</b> Example: Type I error</a></li>
<li class="chapter" data-level="12.7" data-path="data-simulation-in-r.html"><a href="data-simulation-in-r.html#reference"><i class="fa fa-check"></i><b>12.7</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html"><i class="fa fa-check"></i><b>13</b> Power simulation for LMMs</a>
<ul>
<li class="chapter" data-level="13.1" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#reanalysis"><i class="fa fa-check"></i><b>13.1</b> Reanalysis</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#application-context-depression-and-type-of-diagnosis"><i class="fa fa-check"></i><b>13.1.1</b> Application context: Depression and type of diagnosis</a></li>
<li class="chapter" data-level="13.1.2" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#random-intercept-model"><i class="fa fa-check"></i><b>13.1.2</b> Random-intercept model</a></li>
<li class="chapter" data-level="13.1.3" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#random-slope-model"><i class="fa fa-check"></i><b>13.1.3</b> Random-slope model</a></li>
<li class="chapter" data-level="13.1.4" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#partial-pooling"><i class="fa fa-check"></i><b>13.1.4</b> Partial pooling</a></li>
<li class="chapter" data-level="13.1.5" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#by-group-random-slope-model"><i class="fa fa-check"></i><b>13.1.5</b> By-group random-slope model</a></li>
<li class="chapter" data-level="13.1.6" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#means-and-predicted-hdrs-score-by-group"><i class="fa fa-check"></i><b>13.1.6</b> Means and predicted HDRS score by group</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#power-simulation"><i class="fa fa-check"></i><b>13.2</b> Power simulation</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#setup"><i class="fa fa-check"></i><b>13.2.1</b> Setup</a></li>
<li class="chapter" data-level="13.2.2" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#power"><i class="fa fa-check"></i><b>13.2.2</b> Power</a></li>
<li class="chapter" data-level="13.2.3" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#parameter-recovery"><i class="fa fa-check"></i><b>13.2.3</b> Parameter recovery</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="power-simulation-for-lmms.html"><a href="power-simulation-for-lmms.html#references"><i class="fa fa-check"></i><b>13.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-simulation-for-glmms.html"><a href="power-simulation-for-glmms.html"><i class="fa fa-check"></i><b>14</b> Power simulation for GLMMs</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-simulation-for-glmms.html"><a href="power-simulation-for-glmms.html#slides-11"><i class="fa fa-check"></i><b>14.1</b> Slides</a></li>
<li class="chapter" data-level="14.2" data-path="power-simulation-for-glmms.html"><a href="power-simulation-for-glmms.html#exercises-11"><i class="fa fa-check"></i><b>14.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Course on Mixed-effects Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-simulation-in-r" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Data simulation in R<a href="data-simulation-in-r.html#data-simulation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this session, we will use R to simulate data sets. Simulating data can be
considered as the key idea behind hypothesis testing in the frequentist
framework, where we assume that we can repeat the data collection under
identical conditions. In this course, I will (hopefully) show you how to
use it to draw meaningful conclusions from your data.</p>
<div id="overview" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Overview<a href="data-simulation-in-r.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Random numbers generation (<code>rnorm()</code>, <code>runif()</code>, <code>rpois()</code>, <code>rbinom()</code>,
etc.)</li>
<li>Generate categorical variables (<code>factor()</code>, <code>rep()</code>)</li>
<li>Create data frames containing quantitative and categorical variables
(<code>data.frame()</code>, <code>expand.grid()</code>, <code>reshape()</code>)</li>
<li>Drawing many data sets (<code>replicate()</code>, for loops)</li>
</ol>
</div>
<div id="random-numbers-generation" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Random numbers generation<a href="data-simulation-in-r.html#random-numbers-generation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For drawing random numbers from a statistical distribution, the distribution
name is prefixed by “r” (random deviate). See <code>?Distributions</code> for a list of
distributions.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="data-simulation-in-r.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>)                <span class="co"># draw from standard normal distribution</span></span></code></pre></div>
</details>
<pre><code>##  [1] -1.57414237  0.64583220 -1.41354749  0.74087481 -1.07617875  1.40767808  0.68572922
##  [8]  0.34442130  0.07640937 -0.74282934</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="data-simulation-in-r.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>)                <span class="co"># draw from uniform distribution</span></span></code></pre></div>
</details>
<pre><code>##  [1] 0.665568487 0.717326792 0.432359260 0.985922601 0.946721491 0.628644241 0.007869274
##  [8] 0.371857279 0.644679366 0.999616833</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="data-simulation-in-r.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="dv">10</span>, <span class="at">lambda =</span> <span class="dv">1</span>)    <span class="co"># draw from Poisson distribution</span></span></code></pre></div>
</details>
<pre><code>##  [1] 1 2 3 0 2 0 1 2 1 1</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data-simulation-in-r.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling with or without replacement from a vector</span></span>
<span id="cb78-2"><a href="data-simulation-in-r.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<pre><code>##  [1] 5 4 4 4 1 2 1 2 2 3</code></pre>
<p>The random numbers generator in R is seeded: Upon restart of R, new random
numbers are generated. To replicate the results of a simulation, the seed
(starting value) can be set explicitly:</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data-simulation-in-r.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1223</span>)  <span class="co"># set seed, so on each run random numbers will be identical</span></span>
<span id="cb80-2"><a href="data-simulation-in-r.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">3</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.6289619 0.1267469 0.3285822</code></pre>
<div id="normal-distribution" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Normal distribution<a href="data-simulation-in-r.html#normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The normal distribution with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>: <span class="math inline">\(X \sim N(\mu, \sigma^2)\)</span>.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data-simulation-in-r.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span> <span class="fu">hist</span>(<span class="at">breaks =</span> <span class="dv">30</span>)</span></code></pre></div>
</details>
<p><img src="mixed_models_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="multivariate-normal-distribution" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Multivariate normal distribution<a href="data-simulation-in-r.html#multivariate-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="data-simulation-in-r.html#cb83-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>,</span>
<span id="cb83-2"><a href="data-simulation-in-r.html#cb83-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb83-3"><a href="data-simulation-in-r.html#cb83-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb83-4"><a href="data-simulation-in-r.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">xlab =</span> <span class="st">&quot;x1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;x2&quot;</span>)</span></code></pre></div>
</details>
<p><img src="mixed_models_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="poisson-distribution-for-count-data" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Poisson distribution (for count data)<a href="data-simulation-in-r.html#poisson-distribution-for-count-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Poisson distribution is a discrete probability distribution that is used
to model the probability of a given number of events occurring in a fixed
interval of time if these events occur with a known constant mean rate
(<span class="math inline">\(\lambda\)</span>) and independently of the time since the last event.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data-simulation-in-r.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="dv">100</span>, <span class="at">lambda =</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code></pre></div>
</details>
<p><img src="mixed_models_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="binomial-distribution" class="section level3 hasAnchor" number="12.2.4">
<h3><span class="header-section-number">12.2.4</span> Binomial distribution<a href="data-simulation-in-r.html#binomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The binomial distribution with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span> is the discrete
probability distribution of the number of successes in a sequence of n
independent (Bernoulli) experiments: <span class="math inline">\(X \sim Binom(n, \pi)\)</span>.</p>
<p>Generate data from a binomial model using the function <code>rbinom()</code> in R; try
out different values of</p>
<p>– <span class="math inline">\(n\)</span> (10, 500, 2000)<br />
– the parameter <span class="math inline">\(\pi\)</span> (0.5, 0.8, 0.44, 0.515)</p>
<p>and see how this affects the output.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data-simulation-in-r.html#cb85-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>   <span class="co"># 500, 2000</span></span>
<span id="cb85-2"><a href="data-simulation-in-r.html#cb85-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># 0.8, 0.44, 0.515</span></span>
<span id="cb85-3"><a href="data-simulation-in-r.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="data-simulation-in-r.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="at">size =</span> n, <span class="at">prob =</span> p) <span class="sc">|&gt;</span> <span class="fu">table</span>() <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code></pre></div>
</details>
<p><img src="mixed_models_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ul>
<li>With these data, test different null hypotheses using binom.test();
these may or may not coincide with the values of <span class="math inline">\(\pi\)</span> used for data
generation.</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="data-simulation-in-r.html#cb86-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb86-2"><a href="data-simulation-in-r.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(x, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</details>
<pre><code>## 
##  Exact binomial test
## 
## data:  x and 10
## number of successes = 1, number of trials = 10, p-value = 0.02148
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.002528579 0.445016117
## sample estimates:
## probability of success 
##                    0.1</code></pre>
<ul>
<li>If you repeat data generation and testing, can you usually reject H0?</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="data-simulation-in-r.html#cb88-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>, {</span>
<span id="cb88-2"><a href="data-simulation-in-r.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">50</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb88-3"><a href="data-simulation-in-r.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">binom.test</span>(x, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">p =</span> <span class="fl">0.5</span>)<span class="sc">$</span>p.value</span>
<span id="cb88-4"><a href="data-simulation-in-r.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-5"><a href="data-simulation-in-r.html#cb88-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-6"><a href="data-simulation-in-r.html#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="data-simulation-in-r.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.778</code></pre>
</div>
</div>
<div id="creating-factors" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Creating factors<a href="data-simulation-in-r.html#creating-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is usually good practice to create categorical variables explicitly as
factors. Everything that is not a numeric variable should be a factor (e.g.,
id variables).</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data-simulation-in-r.html#cb90-1" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>), <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>)),</span>
<span id="cb90-2"><a href="data-simulation-in-r.html#cb90-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;diverse&quot;</span>))</span>
<span id="cb90-3"><a href="data-simulation-in-r.html#cb90-3" aria-hidden="true" tabindex="-1"></a>sex</span></code></pre></div>
</details>
<pre><code>##  [1] male   male   male   male   male   male   male   male   male   male   male   male  
## [13] male   male   male   female female female female female female female female female
## [25] female female female female female female female female female female female
## Levels: male female diverse</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="data-simulation-in-r.html#cb92-1" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">20</span>), <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;real&quot;</span>, <span class="st">&quot;VR&quot;</span>))</span>
<span id="cb92-2"><a href="data-simulation-in-r.html#cb92-2" aria-hidden="true" tabindex="-1"></a>condition</span></code></pre></div>
</details>
<pre><code>##  [1] real VR   real VR   real VR   real VR   real VR   real VR   real VR   real VR   real
## [18] VR   real VR   real VR   real VR   real VR   real VR   real VR   real VR   real VR  
## [35] real VR   real VR   real VR  
## Levels: real VR</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="data-simulation-in-r.html#cb94-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;ctr&quot;</span>, <span class="st">&quot;trt1&quot;</span>, <span class="st">&quot;trt2&quot;</span>), <span class="at">each =</span> <span class="dv">5</span>))</span>
<span id="cb94-2"><a href="data-simulation-in-r.html#cb94-2" aria-hidden="true" tabindex="-1"></a>group</span></code></pre></div>
</details>
<pre><code>##  [1] ctr  ctr  ctr  ctr  ctr  trt1 trt1 trt1 trt1 trt1 trt2 trt2 trt2 trt2 trt2
## Levels: ctr trt1 trt2</code></pre>
<p>The <code>levels</code> argument sets explicitly the ordering of the factor levels. In
dummy coding (default in R) the first factor level is taken as the reference
category.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="data-simulation-in-r.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>( <span class="sc">~</span> group)</span></code></pre></div>
</details>
<pre><code>##    (Intercept) grouptrt1 grouptrt2
## 1            1         0         0
## 2            1         0         0
## 3            1         0         0
## 4            1         0         0
## 5            1         0         0
## 6            1         1         0
## 7            1         1         0
## 8            1         1         0
## 9            1         1         0
## 10           1         1         0
## 11           1         0         1
## 12           1         0         1
## 13           1         0         1
## 14           1         0         1
## 15           1         0         1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$group
## [1] &quot;contr.treatment&quot;</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="data-simulation-in-r.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(group)</span></code></pre></div>
</details>
<pre><code>##      trt1 trt2
## ctr     0    0
## trt1    1    0
## trt2    0    1</code></pre>
</div>
<div id="data-frames" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Data frames<a href="data-simulation-in-r.html#data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When simulating data for a certain experimental design, this is reflected in
the structure of your data frame. For the <code>group</code> variable from above, the
design looks like this</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="data-simulation-in-r.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>( <span class="sc">~</span> group) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code></pre></div>
</details>
<pre><code>##    (Intercept) grouptrt1 grouptrt2
## 1            1         0         0
## 6            1         1         0
## 11           1         0         1</code></pre>
<p>A linear model will make use of this design and estimate three parameters:
<span class="math display">\[\begin{align*}
  \beta_0 &amp; = \text{mean of control group} \\
  \beta_1 &amp; = \text{effect of treatment group 1} \\
  \beta_2 &amp; = \text{effect of treatment group 2} \\
\end{align*}\]</span></p>
<p>For a repeated-measures (within-subjects) design, the data frame will
usually be in a long format.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="data-simulation-in-r.html#cb102-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb102-2"><a href="data-simulation-in-r.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="data-simulation-in-r.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A and B are recycled to match the length of id</span></span>
<span id="cb102-4"><a href="data-simulation-in-r.html#cb102-4" aria-hidden="true" tabindex="-1"></a>datsim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="dv">4</span>)),</span>
<span id="cb102-5"><a href="data-simulation-in-r.html#cb102-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">A =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>)),</span>
<span id="cb102-6"><a href="data-simulation-in-r.html#cb102-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">B =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>), <span class="at">times =</span> <span class="dv">2</span>)))</span>
<span id="cb102-7"><a href="data-simulation-in-r.html#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="data-simulation-in-r.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>( <span class="sc">~</span> A <span class="sc">+</span> B, datsim)</span></code></pre></div>
</details>
<pre><code>##     B
## A    b1 b2
##   a1 20 20
##   a2 20 20</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="data-simulation-in-r.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>( <span class="sc">~</span> id <span class="sc">+</span> A <span class="sc">+</span> B, datsim) <span class="sc">|&gt;</span> <span class="fu">ftable</span>()</span></code></pre></div>
</details>
<pre><code>##       B b1 b2
## id A         
## 1  a1    1  1
##    a2    1  1
## 2  a1    1  1
##    a2    1  1
## 3  a1    1  1
##    a2    1  1
## 4  a1    1  1
##    a2    1  1
## 5  a1    1  1
##    a2    1  1
## 6  a1    1  1
##    a2    1  1
## 7  a1    1  1
##    a2    1  1
## 8  a1    1  1
##    a2    1  1
## 9  a1    1  1
##    a2    1  1
## 10 a1    1  1
##    a2    1  1
## 11 a1    1  1
##    a2    1  1
## 12 a1    1  1
##    a2    1  1
## 13 a1    1  1
##    a2    1  1
## 14 a1    1  1
##    a2    1  1
## 15 a1    1  1
##    a2    1  1
## 16 a1    1  1
##    a2    1  1
## 17 a1    1  1
##    a2    1  1
## 18 a1    1  1
##    a2    1  1
## 19 a1    1  1
##    a2    1  1
## 20 a1    1  1
##    a2    1  1</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="data-simulation-in-r.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb106-2"><a href="data-simulation-in-r.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="data-simulation-in-r.html#cb106-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb106-4"><a href="data-simulation-in-r.html#cb106-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>))</span>
<span id="cb106-5"><a href="data-simulation-in-r.html#cb106-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>))</span>
<span id="cb106-6"><a href="data-simulation-in-r.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="data-simulation-in-r.html#cb106-7" aria-hidden="true" tabindex="-1"></a>datsim2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">id =</span> id, <span class="at">A =</span> A, <span class="at">B =</span> B) <span class="sc">|&gt;</span> <span class="fu">sort_by</span>(<span class="sc">~</span> id <span class="sc">+</span> A)</span></code></pre></div>
</details>
<p>We can transform the data frame between long and wide data format with
<code>reshape()</code>.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="data-simulation-in-r.html#cb107-1" aria-hidden="true" tabindex="-1"></a>datl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="dv">7</span>)),</span>
<span id="cb107-2"><a href="data-simulation-in-r.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">time =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">times =</span> n),</span>
<span id="cb107-3"><a href="data-simulation-in-r.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">resp =</span> <span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">7</span>,</span>
<span id="cb107-4"><a href="data-simulation-in-r.html#cb107-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">7</span>), <span class="co"># seven means</span></span>
<span id="cb107-5"><a href="data-simulation-in-r.html#cb107-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb107-6"><a href="data-simulation-in-r.html#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="data-simulation-in-r.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(resp <span class="sc">~</span> time, datl, mean)</span></code></pre></div>
</details>
<pre><code>##   time     resp
## 1    0 1.034856
## 2    1 1.648281
## 3    2 2.334861
## 4    3 2.732789
## 5    4 3.600051
## 6    5 3.842304
## 7    6 5.031247</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="data-simulation-in-r.html#cb109-1" aria-hidden="true" tabindex="-1"></a>datw <span class="ot">&lt;-</span> <span class="fu">reshape</span>(datl, <span class="at">direction =</span> <span class="st">&quot;wide&quot;</span>,</span>
<span id="cb109-2"><a href="data-simulation-in-r.html#cb109-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">idvar =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb109-3"><a href="data-simulation-in-r.html#cb109-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">timevar =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb109-4"><a href="data-simulation-in-r.html#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="data-simulation-in-r.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(datw[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
</details>
<pre><code>##   resp.0   resp.1   resp.2   resp.3   resp.4   resp.5   resp.6 
## 1.034856 1.648281 2.334861 2.732789 3.600051 3.842304 5.031247</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="data-simulation-in-r.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(datw[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
</details>
<pre><code>##             resp.0     resp.1      resp.2      resp.3     resp.4      resp.5      resp.6
## resp.0  1.00000000 -0.1515961  0.09738831 -0.32935371 -0.3494126  0.05470633 -0.23307043
## resp.1 -0.15159614  1.0000000  0.54631105  0.12950803 -0.2360399  0.38303961  0.32874890
## resp.2  0.09738831  0.5463110  1.00000000 -0.04246943 -0.3037968  0.05777371  0.12258577
## resp.3 -0.32935371  0.1295080 -0.04246943  1.00000000  0.1153210  0.13318325  0.09966404
## resp.4 -0.34941260 -0.2360399 -0.30379682  0.11532103  1.0000000 -0.42137211 -0.20102584
## resp.5  0.05470633  0.3830396  0.05777371  0.13318325 -0.4213721  1.00000000  0.15399528
## resp.6 -0.23307043  0.3287489  0.12258577  0.09966404 -0.2010258  0.15399528  1.00000000</code></pre>
</div>
<div id="simulate-repeatedly" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Simulate repeatedly<a href="data-simulation-in-r.html#simulate-repeatedly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Reading material on functional programming in R <span class="citation">(<a href="#ref-Wickham2019first" role="doc-biblioref">Wickham, 2019</a>)</span>
<ul>
<li><a href="http://adv-r.had.co.nz/Functions.html" class="uri">http://adv-r.had.co.nz/Functions.html</a></li>
<li><a href="http://adv-r.had.co.nz/Functional-programming.html" class="uri">http://adv-r.had.co.nz/Functional-programming.html</a></li>
<li><a href="http://adv-r.had.co.nz/Functionals.html" class="uri">http://adv-r.had.co.nz/Functionals.html</a></li>
</ul></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="data-simulation-in-r.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1133</span>)</span>
<span id="cb113-2"><a href="data-simulation-in-r.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="dv">3</span>, <span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<pre><code>## [[1]]
##  [1]  1.3234050  1.0672355 -0.4970425 -0.7444275  0.1860472  1.0540061  0.9051997  0.5745372
##  [9]  2.0237698  0.1831237
## 
## [[2]]
##  [1]  0.25400660 -0.71355882  1.44786556  0.90886066 -2.02238191  0.27064121 -0.97261079
##  [8]  0.01889436  2.08511877 -0.88604130
## 
## [[3]]
##  [1]  0.3268653  1.4123795 -0.4843307  2.5777461  0.2671252 -0.9092667 -2.3162740  0.9670641
##  [9] -1.5804482  0.3733937</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="data-simulation-in-r.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1133</span>)</span>
<span id="cb115-2"><a href="data-simulation-in-r.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="dv">3</span>, <span class="fu">rnorm</span>(<span class="dv">10</span>))</span></code></pre></div>
</details>
<pre><code>##             [,1]        [,2]       [,3]
##  [1,]  1.3234050  0.25400660  0.3268653
##  [2,]  1.0672355 -0.71355882  1.4123795
##  [3,] -0.4970425  1.44786556 -0.4843307
##  [4,] -0.7444275  0.90886066  2.5777461
##  [5,]  0.1860472 -2.02238191  0.2671252
##  [6,]  1.0540061  0.27064121 -0.9092667
##  [7,]  0.9051997 -0.97261079 -2.3162740
##  [8,]  0.5745372  0.01889436  0.9670641
##  [9,]  2.0237698  2.08511877 -1.5804482
## [10,]  0.1831237 -0.88604130  0.3733937</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="data-simulation-in-r.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a for loop</span></span>
<span id="cb117-2"><a href="data-simulation-in-r.html#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="data-simulation-in-r.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Create an empty list</span></span>
<span id="cb117-4"><a href="data-simulation-in-r.html#cb117-4" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="dv">3</span>)</span>
<span id="cb117-5"><a href="data-simulation-in-r.html#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="data-simulation-in-r.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Loop to add elements to the list</span></span>
<span id="cb117-7"><a href="data-simulation-in-r.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb117-8"><a href="data-simulation-in-r.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  l1[[i]] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb117-9"><a href="data-simulation-in-r.html#cb117-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-10"><a href="data-simulation-in-r.html#cb117-10" aria-hidden="true" tabindex="-1"></a>l1</span></code></pre></div>
</details>
<pre><code>## [[1]]
##  [1] -1.4462982 -1.0249066  1.7273781  0.7970825 -0.1921147  0.2560200  0.7947771 -0.4665010
##  [9]  0.5127336 -0.4892820
## 
## [[2]]
##  [1]  1.873255506 -0.450625527 -1.060191680 -0.410976388 -0.631345739 -0.646261755
##  [7] -0.347821457  0.002526977 -1.474943882 -0.903203170
## 
## [[3]]
##  [1] -0.5318484 -0.9318605  0.6605868 -1.3563084 -1.4592700 -0.3774795  0.1023129 -0.2826929
##  [9] -0.4166077  0.1255623</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="data-simulation-in-r.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Grow a matrix</span></span>
<span id="cb119-2"><a href="data-simulation-in-r.html#cb119-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb119-3"><a href="data-simulation-in-r.html#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="data-simulation-in-r.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb119-5"><a href="data-simulation-in-r.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mat, <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb119-6"><a href="data-simulation-in-r.html#cb119-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-7"><a href="data-simulation-in-r.html#cb119-7" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
</details>
<pre><code>##              [,1]       [,2]        [,3]
##  [1,] -1.27717070 -0.1744192 -0.09960859
##  [2,]  0.08109145 -1.1686442 -0.06927740
##  [3,]  1.46141004 -0.1793560  0.20608944
##  [4,]  1.03355461 -0.0960317 -2.17113052
##  [5,] -0.31967339 -1.4917276  0.52429185
##  [6,]  0.37209221 -1.1401370  0.04022837
##  [7,]  1.80480805 -0.2392017 -0.10797109
##  [8,]  0.69115420  1.8640513  1.35247834
##  [9,]  1.93660079 -1.3204190 -0.25169725
## [10,]  0.56133067  1.3491119  0.57756123</code></pre>
<div id="simulate-many-data-sets" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Simulate many data sets<a href="data-simulation-in-r.html#simulate-many-data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="data-simulation-in-r.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of data sets</span></span>
<span id="cb121-2"><a href="data-simulation-in-r.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="data-simulation-in-r.html#cb121-3" aria-hidden="true" tabindex="-1"></a>data_sets <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">20</span>, {</span>
<span id="cb121-4"><a href="data-simulation-in-r.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>),</span>
<span id="cb121-5"><a href="data-simulation-in-r.html#cb121-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;ctr&quot;</span>, <span class="st">&quot;trt1&quot;</span>, <span class="st">&quot;trt2&quot;</span>), <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb121-6"><a href="data-simulation-in-r.html#cb121-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">resp =</span> <span class="fu">rnorm</span>(<span class="dv">5</span> <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb121-7"><a href="data-simulation-in-r.html#cb121-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>), <span class="co"># three means</span></span>
<span id="cb121-8"><a href="data-simulation-in-r.html#cb121-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb121-9"><a href="data-simulation-in-r.html#cb121-9" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb121-10"><a href="data-simulation-in-r.html#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb121-11"><a href="data-simulation-in-r.html#cb121-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-12"><a href="data-simulation-in-r.html#cb121-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-13"><a href="data-simulation-in-r.html#cb121-13" aria-hidden="true" tabindex="-1"></a>data_sets[[<span class="dv">1</span>]]</span></code></pre></div>
</details>
<pre><code>##    id group        resp
## 1   1   ctr  0.18938344
## 2   2  trt1  4.60991374
## 3   3  trt2  6.49335383
## 4   4   ctr  1.24668163
## 5   5  trt1  1.97917586
## 6   6  trt2  5.98611621
## 7   7   ctr  0.53481673
## 8   8  trt1  2.32272608
## 9   9  trt2  5.13326355
## 10 10   ctr -0.09014815
## 11 11  trt1  1.61527749
## 12 12  trt2  3.96499841
## 13 13   ctr  1.11900065
## 14 14  trt1  0.68836079
## 15 15  trt2  6.13870532</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="data-simulation-in-r.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use apply functions to fit model to each data set</span></span>
<span id="cb123-2"><a href="data-simulation-in-r.html#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="data-simulation-in-r.html#cb123-3" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb123-4"><a href="data-simulation-in-r.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(resp <span class="sc">~</span> group, <span class="at">data =</span> data)</span>
<span id="cb123-5"><a href="data-simulation-in-r.html#cb123-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-6"><a href="data-simulation-in-r.html#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="data-simulation-in-r.html#cb123-7" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data_sets, fit_model)  <span class="co"># create list of fitted models</span></span>
<span id="cb123-8"><a href="data-simulation-in-r.html#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="data-simulation-in-r.html#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(models[[<span class="dv">1</span>]])</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = resp ~ group, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.57829 -0.51919 -0.06513  0.55724  2.36682 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.5999     0.4820   1.245   0.2370    
## grouptrt1     1.6431     0.6816   2.411   0.0329 *  
## grouptrt2     4.9433     0.6816   7.252 1.01e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.078 on 12 degrees of freedom
## Multiple R-squared:  0.8197, Adjusted R-squared:  0.7897 
## F-statistic: 27.28 on 2 and 12 DF,  p-value: 3.432e-05</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="data-simulation-in-r.html#cb125-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, coef)</span>
<span id="cb125-2"><a href="data-simulation-in-r.html#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="data-simulation-in-r.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(pars)</span></code></pre></div>
</details>
<pre><code>## (Intercept)   grouptrt1   grouptrt2 
##   0.7440095   2.2232360   4.2134159</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="data-simulation-in-r.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">t</span>(pars))</span></code></pre></div>
</details>
<p><img src="mixed_models_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
<div id="example-type-i-error" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Example: Type I error<a href="data-simulation-in-r.html#example-type-i-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="data-simulation-in-r.html#cb128-1" aria-hidden="true" tabindex="-1"></a>lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> <span class="dv">1</span>, cars)       <span class="co"># H0</span></span>
<span id="cb128-2"><a href="data-simulation-in-r.html#cb128-2" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, cars)   <span class="co"># H1</span></span>
<span id="cb128-3"><a href="data-simulation-in-r.html#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="data-simulation-in-r.html#cb128-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb128-5"><a href="data-simulation-in-r.html#cb128-5" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb128-6"><a href="data-simulation-in-r.html#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="data-simulation-in-r.html#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb128-8"><a href="data-simulation-in-r.html#cb128-8" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(lm0)<span class="sc">$</span>sim_1</span>
<span id="cb128-9"><a href="data-simulation-in-r.html#cb128-9" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(sim <span class="sc">~</span> speed, cars)</span>
<span id="cb128-10"><a href="data-simulation-in-r.html#cb128-10" aria-hidden="true" tabindex="-1"></a>  pval[i] <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)<span class="sc">$</span>coef[<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb128-11"><a href="data-simulation-in-r.html#cb128-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-12"><a href="data-simulation-in-r.html#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="data-simulation-in-r.html#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Type I error</span></span>
<span id="cb128-14"><a href="data-simulation-in-r.html#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pval <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.04</code></pre>
</div>
<div id="reference" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Reference<a href="data-simulation-in-r.html#reference" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Wickham2019first" class="csl-entry">
Wickham, H. (2019). <em>Advanced <span>R</span></em> (First edition). CRC press. <a href="http://adv-r.had.co.nz/">http://adv-r.had.co.nz/</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalized-linear-mixed-effects-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-simulation-for-lmms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/nwickel/mixed_models/edit/master/12_datsim.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
