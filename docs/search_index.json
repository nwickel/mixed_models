[["index.html", "Course on Mixed-effects Models at the IWM Overview of dates", " Course on Mixed-effects Models at the IWM Nora Wickelmaier 2024-10-04 Overview of dates Date Topic Resources 28.10.2024 Introduction to regression 11.11.2024 Multiple regression and GLM 25.11.2024 Pre-post designs 09.12.2024 Repeated measures 13.01.2025 Longitudinal data Bates(2010) 27.01.2025 Data simulation for LMM Baayen, Davidson, &amp; Bates (2008) 10.02.2025 Power simulation (G)LMM Wickelmaier (2022) "],["literature.html", "Literature", " Literature This course is mostly built on the following books and papers: Gelman, Hill, and Vehtari (2020) Bates et al. (2015) Baayen, Davidson, and Bates (2008) Wickelmaier (2022) References "],["simple-regression.html", "Chapter 1 Simple regression 1.1 Slides 1.2 Exercises", " Chapter 1 Simple regression This chapter is meant to give a short introduction to simple regression. It is mostly meant to reintroduce some basics concepts, introduce notation, and get everybody on the same page. 1.1 Slides Unable to display PDF file. Download instead. 1.2 Exercises Exercise 1 Simulate a data set based on a simple regression model with \\[\\begin{align*} \\beta_0 &amp; = 0.2\\\\ \\beta_1 &amp; = 0.3\\\\ \\sigma &amp; = 0.5\\\\ x &amp; \\in [1, 20]~\\text{in steps of 1} \\end{align*}\\] What functions in R do we need? Solution Code x &lt;- 1:20 n &lt;- length(x) a &lt;- 0.2 b &lt;- 0.3 sigma &lt;- 0.5 y &lt;- 0.2 + 0.3*x + rnorm(n, sd=sigma) dat &lt;- data.frame(x, y) lm1 &lt;- lm(y ~ x, dat) summary(lm1) mean(resid(lm1)) sd(resid(lm1)) hist(resid(lm1), breaks=15) Code # plot data plot(y ~ x, dat) abline(lm1) Exercise 2 Simulate data with the parameters from Exercise 1 Do not assume that we have one subject per value for \\(x\\), but more than one subject Simulate data for \\(n=40\\) and \\(n=100\\) Hint: Use sample(x, n, replace = TRUE) Re-cover your parameters as done on slide 11 What happens to your standard errors? Solution Code n &lt;- 100 # 40 x0 &lt;- 1:20 x &lt;- sample(x0, n, replace=TRUE) a &lt;- 0.2 b &lt;- 0.3 sigma &lt;- 0.5 y &lt;- 0.2 + 0.3*x + rnorm(n, sd=sigma) dat &lt;- data.frame(x, y) pars &lt;- replicate(2000, { ysim &lt;- 0.2 + 0.3*x + rnorm(n, sd=sigma) lm1 &lt;- lm(ysim ~ x, dat) c(coef(lm1), sigma(lm1)) }) rowMeans(pars) # standard errors apply(pars, 1, sd) hist(pars[1, ]) Code hist(pars[2, ]) Code hist(pars[3, ]) Code plot(y ~ jitter(x), dat) Example to illustrate assumptions Code data(anscombe) lm1 &lt;- lm(y1 ~ x1, anscombe) lm2 &lt;- lm(y2 ~ x2, anscombe) lm3 &lt;- lm(y3 ~ x3, anscombe) lm4 &lt;- lm(y4 ~ x4, anscombe) rbind(coef(lm1), coef(lm2), coef(lm3), coef(lm4)) ## (Intercept) x1 ## [1,] 3.000091 0.5000909 ## [2,] 3.000909 0.5000000 ## [3,] 3.002455 0.4997273 ## [4,] 3.001727 0.4999091 Code par(mfrow=c(2,2)) plot(y1 ~ x1, anscombe, pch=16, col=&quot;blue&quot;) abline(lm1, lwd=2) plot(y2 ~ x2, anscombe, pch=16, col=&quot;blue&quot;) abline(lm2, lwd=2) plot(y3 ~ x3, anscombe, pch=16, col=&quot;blue&quot;) abline(lm3, lwd=2) plot(y4 ~ x4, anscombe, pch=16, col=&quot;blue&quot;) abline(lm4, lwd=2) Code dat &lt;- reshape(anscombe, direction=&quot;long&quot;, varying=list(1:4, 5:8), timevar=&quot;reg&quot;, v.names=c(&quot;x&quot;, &quot;y&quot;))[,-4] lattice::xyplot(y ~ x | as.factor(reg), dat, pch=16, type=c(&quot;p&quot;, &quot;r&quot;)) Code lattice::xyplot(y ~ x | as.factor(reg), dat, pch=16, type=c(&quot;p&quot;, &quot;smooth&quot;)) Code lattice::xyplot(y ~ x | as.factor(reg), dat, pch=16, type=c(&quot;p&quot;, &quot;spline&quot;)) Code par(mfrow=c(2,2)) plot(lm1) Code plot(lm2) Code plot(lm3) Code plot(lm4) "],["generalized-linear-models.html", "Chapter 2 Generalized linear models 2.1 Slides 2.2 Exercises", " Chapter 2 Generalized linear models 2.1 Slides Unable to display PDF file. Download instead. 2.2 Exercises Code #--------------- (1) Exercise 1 --------------- x &lt;- rnorm(100, mean=1) y &lt;- rnorm(100, mean=2) dat &lt;- data.frame(id=1:200, group=rep(c(&quot;x&quot;,&quot;y&quot;), each=100), score=c(x, y)) rm(x,y) t1 &lt;- t.test(score ~ group, dat, var.equal=TRUE) lm1 &lt;- lm(score ~ group, dat) aov1 &lt;- aov(score ~ group, dat) (stat &lt;- list( coef=matrix(c(t1$estimate, lm1$coef, aov1$coef), 2, 3, dimnames=list(NULL, c(&quot;ttest&quot;, &quot;lm&quot;, &quot;aov&quot;))), statistics=matrix(c(t=t1$statistic^2, Flm=summary(lm1)$fstatistic[1], Faov=unlist(summary(aov1))[7]), 1, 3, dimnames=list(NULL, c(&quot;t&quot;,&quot;Flm&quot;,&quot;Faov&quot;)))) ) ## $coef ## ttest lm aov ## [1,] 1.052033 1.052033 1.052033 ## [2,] 2.104433 1.052399 1.052399 ## ## $statistics ## t Flm Faov ## [1,] 57.61559 57.61559 57.61559 Code #--------------- (2) Exercise 2 --------------- data(cars) lm1 &lt;- lm(dist ~ speed, cars) summary(lm1) ## ## Call: ## lm(formula = dist ~ speed, data = cars) ## ## Residuals: ## Min 1Q Median 3Q Max ## -29.069 -9.525 -2.272 9.215 43.201 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -17.5791 6.7584 -2.601 0.0123 * ## speed 3.9324 0.4155 9.464 1.49e-12 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 15.38 on 48 degrees of freedom ## Multiple R-squared: 0.6511, Adjusted R-squared: 0.6438 ## F-statistic: 89.57 on 1 and 48 DF, p-value: 1.49e-12 Code hist(resid(lm1)) Code par(mfrow=c(2,2)) plot(lm1) Code lm2 &lt;- lm(dist ~ speed + I(speed^2), cars) anova(lm1, lm2) ## Analysis of Variance Table ## ## Model 1: dist ~ speed ## Model 2: dist ~ speed + I(speed^2) ## Res.Df RSS Df Sum of Sq F Pr(&gt;F) ## 1 48 11354 ## 2 47 10825 1 528.81 2.296 0.1364 Code #--------------- (3) Exercise 3 --------------- dat &lt;- data.frame(x = 37:43, y = c(2, 3, 10, 25, 34, 36, 39), n = 40) glm1 &lt;- glm(cbind(y, n-y) ~ x, binomial, dat) a &lt;- 1 / coef(glm1)[2] c &lt;- -coef(glm1)[1]/coef(glm1)[2] newx &lt;- seq(37, 43, .1) pre &lt;- predict(glm1, data.frame(x=newx), type=&quot;response&quot;) plot(y/n ~ x, dat, pch=16, ylab=&quot;Probability to say brighter&quot;) lines(pre ~ newx, dat) abline(v=c, h=.5, lty=3) text(39, .8, paste(&quot;PSE =&quot;, round(c,2))) # goodness-of-fit test glms &lt;- glm(cbind(y, n-y) ~ factor(x), binomial, dat) anova(glm1, glms, test=&quot;Chisq&quot;) ## Analysis of Deviance Table ## ## Model 1: cbind(y, n - y) ~ x ## Model 2: cbind(y, n - y) ~ factor(x) ## Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi) ## 1 5 2.6037 ## 2 0 0.0000 5 2.6037 0.7608 Code # overdispersion summary(glm(cbind(y, n-y) ~ x, quasibinomial, dat)) ## ## Call: ## glm(formula = cbind(y, n - y) ~ x, family = quasibinomial, data = dat) ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -47.80797 3.87192 -12.35 6.17e-05 *** ## x 1.20216 0.09724 12.36 6.13e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for quasibinomial family taken to be 0.537067) ## ## Null deviance: 182.7247 on 6 degrees of freedom ## Residual deviance: 2.6037 on 5 degrees of freedom ## AIC: NA ## ## Number of Fisher Scoring iterations: 4 "],["prepost-measurements.html", "Chapter 3 Pre/post measurements 3.1 Slides 3.2 Exercises", " Chapter 3 Pre/post measurements 3.1 Slides Unable to display PDF file. Download instead. 3.2 Exercises Code # TODO: Add exercises "],["repeated-measurements.html", "Chapter 4 Repeated measurements 4.1 Slides 4.2 Exercises", " Chapter 4 Repeated measurements 4.1 Slides Unable to display PDF file. Download instead. 4.2 Exercises Code # TODO: Add exercises "],["longitudinal-data.html", "Chapter 5 Longitudinal data 5.1 Slides 5.2 Exercises", " Chapter 5 Longitudinal data 5.1 Slides Unable to display PDF file. Download instead. 5.2 Exercises Code # TODO: Add exercises "],["data-simulation-for-linear-mixed-effects-models.html", "Chapter 6 Data simulation for linear mixed-effects models 6.1 Slides 6.2 Exercises", " Chapter 6 Data simulation for linear mixed-effects models 6.1 Slides Unable to display PDF file. Download instead. 6.2 Exercises Code # TODO: Add exercises "],["introduction-to-power.html", "Chapter 7 Introduction to power 7.1 Slides 7.2 Exercises", " Chapter 7 Introduction to power 7.1 Slides Code # TODO: Add slides 7.2 Exercises Code # TODO: Add exercises "],["power-simulation-for-glmm.html", "Chapter 8 Power simulation for GLMM 8.1 Slides 8.2 Exercises", " Chapter 8 Power simulation for GLMM 8.1 Slides Unable to display PDF file. Download instead. 8.2 Exercises Code # TODO: Add exercises "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
